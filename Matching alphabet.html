<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case Match: Alphabet Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&display=swap');
        :root {
            --primary-color: #4f46e5; /* Indigo-600 */
            --secondary-color: #fde047; /* Yellow-300 */
            --bg-color: #f3f4f6; /* Gray-100 */
        }
        body {
            font-family: 'Fredoka', sans-serif;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 700px;
            background-color: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        #game-board {
            display: grid;
            /* 4-column grid for 12 cards (4x3 layout) */
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 30px 0;
        }

        .card {
            background: linear-gradient(145deg, var(--primary-color), #6366f1);
            color: white;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            border-radius: 12px;
            cursor: pointer;
            perspective: 1000px;
            transition: transform 0.3s ease-in-out;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            user-select: none;
            position: relative;
            aspect-ratio: 1 / 1; /* Ensure cards are square */
        }

        .card-inner {
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: 700;
        }

        .card-front {
            background: linear-gradient(145deg, var(--primary-color), #6366f1);
            color: white;
            font-size: 2.5rem;
        }

        .card-back {
            background-color: var(--secondary-color);
            color: var(--primary-color);
            transform: rotateY(180deg);
            font-size: 3rem;
        }

        .card.matched {
            pointer-events: none;
            opacity: 0.5;
        }
        
        /* Responsive adjustments for smaller screens */
        @media (max-width: 600px) {
            #game-board {
                grid-template-columns: repeat(4, 1fr);
                gap: 8px;
            }
            .card {
                height: 70px;
                font-size: 2rem;
            }
            .card-back {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-4xl font-bold text-indigo-700 mb-2">Case Match ðŸ” ðŸ”¡</h1>
        <p class="text-gray-600 mb-6">Match the **uppercase** letter with its **lowercase** partner!</p>

        <div class="flex justify-between items-center bg-gray-100 p-4 rounded-lg shadow-inner mb-4">
            <div class="text-lg text-gray-700">
                Pairs Found: <span id="score" class="font-bold text-green-600">0</span> / 6
            </div>
            <div class="text-lg text-gray-700">
                Moves: <span id="moves" class="font-bold text-red-500">0</span>
            </div>
        </div>

        <div id="game-board">
            <!-- Cards will be injected here (now 12 total, numbered 1-12) -->
        </div>

        <button id="restart-btn" class="bg-indigo-500 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition duration-300 transform hover:scale-105">
            Restart Game
        </button>

        <!-- Custom Modal for Game Over: Displays the final score (move count) -->
        <div id="game-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50">
            <div class="bg-white p-8 rounded-lg shadow-2xl text-center max-w-sm">
                <h2 class="text-3xl font-bold text-indigo-600 mb-4">ðŸŽ‰ Congratulations! ðŸŽ‰</h2>
                <!-- This paragraph shows the final score (move count) -->
                <p class="text-gray-700 mb-6 text-lg">You found all <strong class="text-indigo-600">6 pairs</strong> in <strong id="final-moves" class="text-red-500 text-xl">0</strong> moves!</p>
                <button id="modal-restart-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                    Play Again!
                </button>
            </div>
        </div>

    </div>

    <script>
        // Global game state variables
        let gameBoard = document.getElementById('game-board');
        let scoreDisplay = document.getElementById('score');
        let movesDisplay = document.getElementById('moves');
        let gameModal = document.getElementById('game-modal');
        let finalMovesDisplay = document.getElementById('final-moves');

        let allLetters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        let cardValues = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let totalMoves = 0;
        let isProcessing = false; // Flag to prevent rapid clicks

        // Game size is 6 pairs (12 total cards)
        const MAX_PAIRS = 6;

        /**
         * Utility function to shuffle an array (Fisher-Yates algorithm).
         * @param {Array} array The array to shuffle.
         * @returns {Array} The shuffled array.
         */
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * Selects 6 random unique letters and generates upper/lower case pairs.
         */
        function generateCards() {
            let letters = allLetters.split('');
            // Shuffle the alphabet and pick the first MAX_PAIRS (6) letters
            shuffle(letters);
            let selectedLetters = letters.slice(0, MAX_PAIRS);

            cardValues = [];
            selectedLetters.forEach(letter => {
                // Add uppercase
                cardValues.push(letter);
                // Add lowercase
                cardValues.push(letter.toLowerCase());
            });

            // Final shuffle of all 12 cards
            shuffle(cardValues);
        }

        /**
         * Renders the cards to the HTML game board.
         */
        function renderCards() {
            gameBoard.innerHTML = '';
            cardValues.forEach((value, index) => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.value = value;
                card.dataset.index = index;
                card.onclick = () => handleCardClick(card);

                // Use index + 1 for the card number (1 to 12)
                const cardNumber = index + 1;

                card.innerHTML = `
                    <div class="card-inner">
                        <!-- Card front now shows the choice number -->
                        <div class="card-front text-4xl">${cardNumber}</div>
                        <div class="card-back">${value}</div>
                    </div>
                `;
                gameBoard.appendChild(card);
            });
        }

        /**
         * Handles the click event on a card.
         * @param {HTMLElement} card The card element that was clicked.
         */
        function handleCardClick(card) {
            if (isProcessing || card.classList.contains('flipped') || card.classList.contains('matched')) {
                return;
            }

            // Flip the card
            card.classList.add('flipped');
            flippedCards.push(card);

            if (flippedCards.length === 2) {
                isProcessing = true;
                totalMoves++;
                movesDisplay.textContent = totalMoves;
                setTimeout(checkForMatch, 800); // Delay for user to see the second card
            }
        }

        /**
         * Checks if the two flipped cards form a valid upper/lower case match.
         */
        function checkForMatch() {
            const [card1, card2] = flippedCards;
            const value1 = card1.dataset.value;
            const value2 = card2.dataset.value;

            // Check if the letters are a match (case-insensitive) AND are not the same case (e.g., A/a is a match, A/A is not).
            const isMatch = (value1.toUpperCase() === value2.toUpperCase()) && (value1 !== value2);

            if (isMatch) {
                // Match found
                card1.classList.add('matched');
                card2.classList.add('matched');
                matchedPairs++;
                scoreDisplay.textContent = matchedPairs;

                // Check win condition
                if (matchedPairs === MAX_PAIRS) {
                    showGameOver();
                }
            } else {
                // No match, flip them back
                card1.classList.remove('flipped');
                card2.classList.remove('flipped');
            }

            // Reset for the next turn
            flippedCards = [];
            isProcessing = false;
        }

        /**
         * Displays the game over modal.
         */
        function showGameOver() {
            // This is where the final score (totalMoves) is set in the modal.
            finalMovesDisplay.textContent = totalMoves;
            gameModal.classList.remove('hidden');
        }

        /**
         * Resets the game state and starts a new game.
         */
        function initGame() {
            flippedCards = [];
            matchedPairs = 0;
            totalMoves = 0;
            isProcessing = false;

            scoreDisplay.textContent = matchedPairs;
            movesDisplay.textContent = totalMoves;
            gameModal.classList.add('hidden');

            generateCards();
            renderCards();
        }

        // Event listeners
        document.getElementById('restart-btn').addEventListener('click', initGame);
        document.getElementById('modal-restart-btn').addEventListener('click', initGame);

        // Start the game when the window loads
        window.onload = initGame;
    </script>
</body>
</html>
